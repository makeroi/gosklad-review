# 7.2. Качество миграций

## Результат
- **Статус:** ⚠️ Требует проверки
- **Severity:** S2
- **Краткое заключение:** не гарантирована обратимость миграций; присутствуют SQL-дампы и кастомные скрипты для правок данных.

## Наблюдение
- В каталоге `database/_migrations` лежат «ручные» миграции; рядом — SQL-файл (`database/gs (2).sql`).
- Многие изменения данных выполняются через консольные команды (`app/Console/Commands/*`) вместо миграций.
- Нет стандартной практики `--step` и разделения миграций на мелкие шаги.

## Доказательства
- `app/Console/Commands/LogsClear.php`, `ProcessOrder.php`, `Fix*` — выполняют манипуляции с данными.
- `database/migrations` — требуется ревизия на обратимость.

## Риски
- Невозможно выполнить `php artisan migrate:rollback`.
- Сложности при деплое: риск зависаний/блокировок таблиц.

## Рекомендации
1. Проанализировать существующие миграции на обратимость, при необходимости — разделить на шаги.
2. Перенести бизнес-скрипты из `Console/Commands` в миграции/Seeder с чёткой логикой.
3. Использовать `php artisan migrate --step` в CI/CD, документировать процедуру отката.

## Следующие шаги
- 🟧 Ответственный: Backend
- ⏱ Срок: 4 недели (поэтапно)
- 📌 Контроль: все новые миграции обязаны быть обратимыми и быстрыми.
