# 12.3. Защита интерфейсов

## Результат
- **Статус:** ❌ Не пройдено
- **Severity:** S1
- **Краткое заключение:** отсутствуют rate-limit, подписи вебхуков и строгие правила CORS; многие эндпоинты доступны без CSRF-защиты.

## Наблюдение
- В `routes/web.php` нет middleware `throttle` или `signed`.
- Вебхуки (`pushProducts`, `to-amocrm`) не проверяют подпись источника.
- CORS настроен по умолчанию, ограничения доменов не описаны.

## Доказательства
- `routes/web.php`
- `config/cors.php` — требует проверки (по умолчанию разрешён `*`?)

## Риски
- DoS-атаки через публичные эндпоинты.
- Подделка запросов от имени интеграций (replay-атаки).
- XSS/CSRF для web-части.

## Рекомендации
1. Добавить middleware `throttle`/`rate-limit` и `signed` на критичные маршруты.
2. Реализовать проверку подписи вебхуков (HMAC).
3. Ограничить CORS доменами заказчика, отключить `*`.
4. Проверить CSRF-защиту для форм и перенести API-названия в `routes/api.php`.

## Следующие шаги
- 🟥 Ответственный: Backend
- ⏱ Срок: 1 неделя
- 📌 Контроль: security тесты (OWASP Top 10) и регулярные пен-тесты.
