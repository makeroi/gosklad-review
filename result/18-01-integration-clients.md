# 18.1. Клиенты интеграций

## Результат
- **Статус:** ❌ Не пройдено
- **Severity:** S1
- **Краткое заключение:** HTTP-клиенты отключают проверку SSL, не имеют таймаутов, retry и circuit breaker.

## Наблюдение
- Функция `requestGet()` в `helpers.php` устанавливает `CURLOPT_SSL_VERIFYHOST = 0` и `CURLOPT_SSL_VERIFYPEER = false`.
- `DocumentService::post()` также отключает проверку SSL.
- Нет таймаутов и обработки ошибок для интеграций (amoCRM/Kommo/360dialog).

## Доказательства
- `app/Helpers/helpers.php:740-763`
- `app/Services/DocumentService.php:282-296`

## Риски
- MITM-атаки и подмена ответов внешних сервисов.
- Повторные запросы приводят к двойным списаниям и ошибкам.

## Рекомендации
1. Использовать Guzzle/HTTP-клиент Laravel с включённой проверкой SSL.
2. Добавить таймауты, retry/backoff, circuit breaker (например, пакет `resilience`).
3. Логировать ошибки интеграций и уведомлять ответственных.

## Следующие шаги
- 🟥 Ответственный: Backend
- ⏱ Срок: 1 неделя
- 📌 Контроль: интеграционные тесты + мониторинг ошибок.
